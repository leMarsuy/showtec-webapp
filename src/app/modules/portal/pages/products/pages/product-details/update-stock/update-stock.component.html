<p mat-dialog-title>
  NEW STOCK: <u>{{ data.name }}</u>
  <small
    class="text-xs float-right mt-2 font-light text-emerald-500 top-0"
    matTooltip="Barcode Listener Activated"
  >
    <mat-icon>rss_feed</mat-icon>
  </small>
</p>
<mat-dialog-content>
  <div class="flex gap-2">
    <mat-card class="p-4 w-[20rem]" [formGroup]="stockDetailsForm">
      <mat-form-field class="w-full">
        <mat-label>Date Purchased</mat-label>
        <input
          matInput
          [matDatepicker]="purchasePicker"
          formControlName="purchaseDate"
          placeholder="MM/DD/YYYY"
        />
        <mat-datepicker-toggle
          matIconSuffix
          [for]="purchasePicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #purchasePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Warehouse</mat-label>
        <input
          type="text"
          matInput
          formControlName="_warehouseId"
          [matAutocomplete]="warehouseAuto"
        />
        <mat-autocomplete
          #warehouseAuto="matAutocomplete"
          [displayWith]="displayFn"
        >
          @for (option of filteredWarehouses | async; track option) {
          <mat-option [value]="option._id">{{ option.name }}</mat-option>
          }
        </mat-autocomplete>
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Supplier</mat-label>
        <input
          type="text"
          matInput
          formControlName="_supplierId"
          [matAutocomplete]="supplierAuto"
        />
        <mat-autocomplete
          #supplierAuto="matAutocomplete"
          [displayWith]="displayFn"
        >
          @for (option of filteredSuppliers | async; track option) {
          <mat-option [value]="option._id">{{ option.name }}</mat-option>
          }
        </mat-autocomplete>
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Purchase Cost</mat-label>
        <input matInput type="number" formControlName="purchaseCost" />
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Remarks</mat-label>
        <textarea matInput rows="3" formControlName="remarks"></textarea>
      </mat-form-field>
    </mat-card>
    <mat-card class="p-4 grow">
      <div class="flex border-b-2 border-gray-200 py-2 mb-2">
        <div class="w-[5rem] flex-none">
          <mat-checkbox></mat-checkbox>
        </div>
        <div class="w-full px-4 font-black content-center">
          <p>Serial Number</p>
        </div>
        <div class="w-[12rem] flex-none px-4 font-black content-center">
          Date Scanned
        </div>
      </div>
      <div class="h-[13rem] overflow-y-auto border-b-2 border-gray-200 pb-2">
        @for (stock of scannedStocks; track $index) {
        <div class="flex">
          <div class="w-[5rem] flex-none"><mat-checkbox></mat-checkbox></div>
          <div class="w-full px-4 content-center">{{ stock.serialNumber }}</div>
          <div class="w-[12rem] flex-none px-4 content-center">
            {{ stock.scanDate | date : "MM-dd-YY, hh:mm:ss" }}
          </div>
        </div>
        }
        <div class="p-4 text-center text-gray-400">-- end of list --</div>
      </div>

      <div class="absolute bottom-0 flex gap-2" [formGroup]="stockForm">
        <mat-form-field class="w-[20rem]" appearance="outline">
          <input
            matInput
            placeholder="Serial No."
            formControlName="serialNumber"
            (keyup.enter)="addStock()"
          />
          <mat-icon matSuffix>qr_code</mat-icon>
        </mat-form-field>
        <button mat-flat-button class="mat-button-lg" (click)="addStock()">
          Encode
        </button>
      </div>
    </mat-card>
    <mat-card class="p-4 w-full w-[20rem] flex flex-none">
      <h1 class="text-5xl font-black mb-3">{{ scannedStocks.length }}</h1>
      <p>Total Count</p>
    </mat-card>
  </div>
</mat-dialog-content>
<mat-dialog-actions>
  <div class="w-full flex justify-between">
    <button mat-button color="warn" mat-dialog-close="">Cancel</button>

    <button
      mat-raised-button
      color="primary"
      cdkFocusInitial
      [disabled]="!scannedStocks.length"
      (click)="stockToProduct()"
    >
      Stock to {{ data.name }}
    </button>
  </div>
</mat-dialog-actions>
