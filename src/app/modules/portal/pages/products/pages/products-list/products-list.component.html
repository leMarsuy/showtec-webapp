<div class="flex gap-4">
  <div
    class="flex flex-col w-[24rem] text-gray-900 h-fit sticky top-16 flex-none gap-4"
  >
    <div class="rounded-xl bg-white p-4">
      <form [formGroup]="searchForm">
        <mat-form-field appearance="outline" class="w-full">
          <mat-select formControlName="searchField">
            @for (field of searchFields; track field) {
            <mat-option [value]="field.value">{{ field.label }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-full">
          <input
            matInput
            placeholder="Search Product"
            formControlName="searchText"
            (keyup.enter)="getProducts()"
          />
        </mat-form-field>
      </form>

      <div class="flex justify-end gap-4">
        <button
          *ngIf="searchForm.dirty"
          mat-button
          color="warn"
          (click)="clearForm()"
        >
          Clear
        </button>
        <button
          mat-button
          [disabled]="!searchForm.dirty"
          color="primary"
          (click)="getProducts()"
        >
          Apply Filter
        </button>
      </div>
    </div>
    <!-- <div class="rounded-xl bg-white p-4">asdasdasd</div> -->
  </div>

  <div class="rounded-xl bg-white p-4 w-full text-gray-900">
    <div class="flex">
      <button mat-icon-button (click)="getProducts()">
        <mat-icon class="mr-2"> refresh </mat-icon>
      </button>
      <button
        mat-icon-button
        (click)="downloadAllStocks()"
        [disabled]="downloading"
        matTooltip="Download Serial Numbers"
      >
        <mat-icon class="mr-2">
          {{ downloading ? "downloading" : "download" }}
        </mat-icon>
      </button>
      <button
        mat-icon-button
        (click)="downloadAllProducts()"
        [disabled]="downloading"
        matTooltip="Download Products"
      >
        <mat-icon class="mr-2">
          {{ downloading ? "downloading" : "download_for_offline" }}
        </mat-icon>
      </button>
    </div>
    @if(downloading){
    <mat-progress-bar
      mode="determinate"
      [value]="progressPercentage"
      color="warn"
    ></mat-progress-bar>
    }

    <app-table
      [dataSource]="products"
      [columns]="columns"
      [page]="page"
      (rowEmitter)="rowEvent($event)"
      (pageEmitter)="pageEvent($event)"
    ></app-table>
  </div>
</div>
